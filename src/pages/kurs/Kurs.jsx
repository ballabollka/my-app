import React, { useState, useEffect } from 'react';
import './Kurs.css';
import { Link, useNavigate } from 'react-router-dom';
import axios from 'axios';

const Kurs = () => {
  const [activeTab, setActiveTab] = useState('kids');
  const [courses, setCourses] = useState([]);

  // –ë–µ—Ä—ë–º API URL –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è
  const API_URL = process.env.REACT_APP_API_URL;

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é
  const navigate = useNavigate();

  useEffect(() => {
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é API_URL –≤–º–µ—Å—Ç–æ —Ö–∞—Ä–¥–∫–æ–¥–∞
    axios.get(`${API_URL}/courses/api/courses/`)
      .then(response => {
        setCourses(response.data);
      })
      .catch(error => {
        console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫—É—Ä—Å–æ–≤:", error);
      });
  }, [API_URL]);

  const filteredCourses = courses.filter(course => course.age_group === activeTab);

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –∫–Ω–æ–ø–∫—É "–æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É"
  const handleConsultationClick = () => {
    navigate('/freelesson');
  };

  return (
    <div className='section_kurs'>
      <div className='container_kurs'>
        <div className='section'>
          <h1>–ö—É—Ä—Å—ã</h1>

          <div className='tabs'>
            <button 
              className={`tab-button ${activeTab === 'kids' ? 'active' : ''}`}
              onClick={() => setActiveTab('kids')}
            >
              –ú–∞–ª—ã—à–∞–º
            </button>
            <button 
              className={`tab-button ${activeTab === 'school' ? 'active' : ''}`}
              onClick={() => setActiveTab('school')}
            >
              –®–∫–æ–ª—å–Ω–∏–∫–∞–º
            </button>
          </div>

          <div className='kurs_grid'>
            {filteredCourses.map(course => (
              <div className='kurs' key={course.id}>
                <h2>{course.title}</h2>
                <p>{course.age}</p>
                <p>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫—É—Ä—Å–∞: {course.duration}</p>
                <p>–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É—Ä–æ–∫–∞: {course.lesson_time}</p>
                <p>{course.description}</p>
                <Link to={`/courses/${course.id}`} className="b_kurs">–ø–æ–¥—Ä–æ–±–Ω–µ–µ</Link>
                <Link to="/register" className="bb_kurs">–∑–∞–ø–∏—Å–∞—Ç—å—Å—è</Link>
              </div>
            ))}
          </div>
        </div>
      </div>

      <div className='kurs_polosa'>
        <h1>–ù–µ –∑–Ω–∞–µ—Ç–µ —á—Ç–æ –≤—ã–±—Ä–∞—Ç—å?</h1>
        <p>–û—Å—Ç–∞–≤—å—Ç–µ –∑–∞—è–≤–∫—É –Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é: –º—ã –ø–æ–º–æ–∂–µ–º —Å –≤—ã–±–æ—Ä–æ–º üß†</p>
        <button className='bb_polosa' onClick={handleConsultationClick}>–æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
      </div>
    </div>
  );
};

export default Kurs;
